# Intestinal Barrier Damage Machine Learning

Machine learning prediction models for intestinal barrier damage based on metabolomics data.

## ğŸ“ Project Structure

```
Intestinal barrier damage machine learning/
â”œâ”€â”€ data/                           # Data folder
â”‚   â”œâ”€â”€ metabolites_features.xlsx   # Raw metabolite feature data
â”‚   â”œâ”€â”€ selected_features.xlsx      # Selected feature data
â”‚   â””â”€â”€ Lasso_feature_frequency.xlsx # LASSO feature selection frequency (generated by 01)
â”œâ”€â”€ results/                        # Output folder
â”‚   â”œâ”€â”€ trained_models/             # Trained models (.pkl files)
â”‚   â””â”€â”€ visualizations/             # Visualization images
â”œâ”€â”€ 01_feature_selection_lasso.py   # LASSO feature selection
â”œâ”€â”€ 02_feature_selection_ensemble.py # Ensemble feature selection
â”œâ”€â”€ 03_regression_models.py         # Regression model training & evaluation
â”œâ”€â”€ 04_shap_pls.py                  # SHAP analysis for PLS model
â”œâ”€â”€ 05_shap_linear_models.py        # SHAP analysis for linear models
â”œâ”€â”€ 06_visualization_feature_importance.py  # Feature importance visualization
â”œâ”€â”€ 07_visualization_lasso_frequency.py     # LASSO frequency visualization
â”œâ”€â”€ 08_visualization_shap_combined.py       # Combined SHAP visualization
â””â”€â”€ README.md
```

## ğŸ”§ Requirements

Python >= 3.8

Install dependencies:
```bash
pip install -r requirements.txt
```

## ğŸ“Š Data Format

### metabolites_features.xlsx
- **Sheet1**: Feature matrix (samples Ã— metabolites), first column is sample ID, first row is feature names
- **Sheet2**: Target variable, first column is sample ID, second column is target value

### selected_features.xlsx
- **Sheet1**: Selected feature matrix
- **Sheet2**: Corresponding target variable

## ğŸš€ Workflow

Run scripts in numerical order:

### 1ï¸âƒ£ Feature Selection Phase

```bash
# LASSO Bootstrap feature selection (100 iterations)
python 01_feature_selection_lasso.py

# Ensemble feature selection (RandomForest + XGBoost)
python 02_feature_selection_ensemble.py
```

**Outputs**:
- `results/Lasso_feature_frequency.xlsx` - LASSO feature selection frequency
- `results/RandomForest_Selected_Features.xlsx` - Random Forest feature importance
- `results/XGBoost_Selected_Features.xlsx` - XGBoost feature importance

### 2ï¸âƒ£ Model Training Phase

```bash
# Five-model regression analysis (ElasticNet, Bayesian Ridge, Linear, PLS, SVR)
python 03_regression_models.py
```

**Outputs**:
- `results/five_models_detailed_results.xlsx` - Detailed model evaluation results
- `results/trained_models/*.pkl` - Trained model files

**Evaluation Metrics**:
- 5Ã—100 Repeated Cross-Validation
- Bootstrap Validation (n=1000)
- Cross-seed Validation (10 random seeds)
- RÂ², RMSE, MAE, Overfitting Analysis

### 3ï¸âƒ£ SHAP Interpretability Analysis

```bash
# SHAP analysis for PLS model
python 04_shap_pls.py

# SHAP analysis for linear models (ElasticNet, Bayesian Ridge, Linear Regression)
python 05_shap_linear_models.py
```

**Outputs**:
- `results/visualizations/` - SHAP visualization images
- `results/shap_values_*.xlsx` - SHAP value data

### 4ï¸âƒ£ Visualization Phase

```bash
# Feature importance bar plots
python 06_visualization_feature_importance.py

# LASSO feature selection frequency plot
python 07_visualization_lasso_frequency.py

# Combined SHAP plot (Summary + Dependence)
python 08_visualization_shap_combined.py
```

**Outputs**:
- `results/visualizations/` - All visualization images

## ğŸ“ˆ Model Description

| Model | Description | Use Case |
|-------|-------------|----------|
| ElasticNet | L1+L2 regularization | High-dimensional sparse features |
| Bayesian Ridge | Bayesian linear regression | Uncertainty estimation |
| Linear Regression | Ordinary least squares | Baseline comparison |
| PLS | Partial least squares | Multicollinearity |
| SVR | Support vector regression | Non-linear relationships |

## ğŸ“ Notes

1. **Data Preparation**: Ensure data files are placed in the `data/` folder
2. **Execution Order**: Run scripts in numerical order; later scripts depend on earlier outputs
3. **Path Configuration**: All scripts use relative paths; run from project root directory
4. **Memory Requirements**: Bootstrap and SHAP analysis may require significant memory

## ğŸ“„ License

MIT License

## ğŸ‘¥ Author

[Your Name]

## ğŸ“§ Contact

[Your Email]
